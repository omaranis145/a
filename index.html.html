<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¹Ø¨ÙˆØ¯ÙŠØ© ÙØ§Ø·Ù…Ø© - V0.4.2</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: Tahoma;
      text-align: center;
      padding: 20px;
    }
    .hidden { display: none; }
    .foot { position: relative; display: inline-block; }
    .spot {
      width: 20px;
      height: 20px;
      background: #1a1a1a;
      border-radius: 50%;
      position: absolute;
      cursor: pointer;
    }
    #timer { font-size: 22px; color: red; margin-top: 10px; }
    input[type="text"], input[type="password"] {
      margin-top: 10px;
      padding: 10px;
      width: 300px;
    }
    img {
      width: 90vw;
      max-width: 800px;
      height: auto;
      margin-bottom: 20px;
    }
    #imageList img {
      max-width: 100px;
      margin: 5px;
      border: 2px solid green;
    }
  </style>
</head>
<body oncontextmenu="return false;">

  <!-- Ø´Ø§Ø´Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± -->
  <div id="passwordScreen">
    <h2>ğŸ”’ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ø¯Ø®ÙˆÙ„</h2>
    <input type="password" id="passInput" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <button onclick="checkPassword()">Ø¯Ø®ÙˆÙ„</button>
    <p id="passMsg" style="color:red;"></p>
  </div>

  <!-- Ø§Ù„Ù„Ø¹Ø¨Ø© -->
  <div id="game" class="hidden">
    <h1>ğŸ‘£ Ø¹Ø¨ÙˆØ¯ÙŠØ© ÙØ§Ø·Ù…Ø© V0.4.2</h1>
    <audio id="intro" src="fatima_intro.mp3" autoplay></audio>

    <div class="foot">
      <img src="foot_close.jpg" alt="Ù‚Ø¯Ù… ÙØ§Ø·Ù…Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©">
      <div id="spotsContainer"></div>
    </div>

    <div id="timer">Ø§Ù„ÙˆÙ‚Øª: 300</div>
    <button onclick="startTasks()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ù‡Ù…Ø©</button>

    <h2>âœï¸ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø·Ø§Ø¹Ø©</h2>
    <p>Ø§ÙƒØªØ¨ ÙŠØ¯ÙˆÙŠÙ‹Ø§ ÙÙ‚Ø·: <b>Ø£Ù†Ø§ Ø¹Ø¨Ø¯Ùƒ ÙŠØ§ ÙØ§Ø·Ù…Ø©</b> (<span id="targetRepeat">10</span> Ù…Ø±Ø§Øª)</p>
    <input type="text" id="slaveInput" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ ÙÙ‚Ø·..."
      onpaste="failCopy()" oncopy="failCopy()" oncut="failCopy()">
    <button onclick="checkWriting()">ØªØ­Ù‚Ù‚</button>
    <p id="resultMsg"></p>
  </div>

  <!-- Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ± -->
  <div id="photoHider" class="hidden">
    <h2>ğŸ–¼ï¸ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±</h2>
    <input type="file" id="imageInput" multiple accept="image/*" />
    <div id="imageList"></div>
    <p style="color:gray;">* Ø§Ù„ØµÙˆØ± Ù…Ø­Ù…ÙŠØ© ÙˆÙ„Ø§ ØªØ¸Ù‡Ø± Ø¥Ù„Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>
  </div>

  <!-- Ø§Ù„Ø£ØµÙˆØ§Øª -->
  <audio id="cleanCmd" src="fatima_clean_command.mp3"></audio>
  <audio id="timerStart" src="fatima_timer_start.mp3"></audio>
  <audio id="success" src="fatima_success.mp3"></audio>
  <audio id="punishment" src="fatima_punishment.mp3"></audio>
  <audio id="antiCopy" src="fatima_anti_copy.mp3"></audio>

  <script>
    // ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
    function checkPassword() {
      const val = document.getElementById("passInput").value;
      if (val === "0000") {
        document.getElementById("passwordScreen").classList.add("hidden");
        document.getElementById("game").classList.remove("hidden");
      } else {
        document.getElementById("passMsg").textContent = "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©!";
      }
    }

    let failCount = parseInt(localStorage.getItem("failCount")) || 0;
    let timeLeft = 300;
    let timer;
    let cleaned = 0;
    let totalSpots = 5 + failCount * 5;
    let writeCount = 10 + failCount * 5;

    function playAudio(id) {
      const audio = document.getElementById(id);
      if (audio) audio.play();
    }

    function failCopy() {
      playAudio("antiCopy");
      alert("Ù†Ø³Ø®ØªØŸ Ø§Ù„Ù…Ù‡Ù…Ø© ÙØ´Ù„Øª! Ø³ØªÙØ¹Ø§Ù‚Ø¨.");
      failMission();
      return false;
    }

    function generateSpots(n) {
      const container = document.getElementById("spotsContainer");
      container.innerHTML = '';
      for (let i = 0; i < n; i++) {
        const spot = document.createElement("div");
        spot.className = "spot";
        spot.style.top = Math.random() * 400 + "px";
        spot.style.left = Math.random() * 600 + "px";
        spot.onclick = function () {
          spot.style.display = "none";
          cleaned++;
          if (cleaned === totalSpots) {
            clearInterval(timer);
            playAudio("success");
            alert("Ø£Ø­Ø³Ù†Øª! Ù†Ø¸ÙØª Ù‚Ø¯Ù… Ø§Ù„Ù…Ù„ÙƒØ©. Ø§Ù„Ø¢Ù† Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©...");
            startSecondTask();
          }
        };
        container.appendChild(spot);
      }
    }

    function startTasks() {
      cleaned = 0;
      timeLeft = 300;
      document.getElementById("slaveInput").value = "";
      document.getElementById("resultMsg").textContent = "";
      document.getElementById("targetRepeat").textContent = writeCount;
      generateSpots(totalSpots);
      document.getElementById("timer").textContent = "Ø§Ù„ÙˆÙ‚Øª: 300";
      playAudio("cleanCmd");
      playAudio("timerStart");

      timer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").textContent = "Ø§Ù„ÙˆÙ‚Øª: " + timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timer);
          failMission();
        }
      }, 1000);
    }

    function failMission() {
      playAudio("punishment");
      alert("ÙØ´Ù„Øª! Ø³ØªØ¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯ ÙˆØµØ¹ÙˆØ¨Ø© Ø£ÙƒØ¨Ø±.");
      failCount++;
      localStorage.setItem("failCount", failCount);
      totalSpots = 5 + failCount * 5;
      writeCount = 10 + failCount * 5;
      startTasks();
    }

    function checkWriting() {
      const val = document.getElementById("slaveInput").value.trim();
      const count = (val.match(/Ø£Ù†Ø§ Ø¹Ø¨Ø¯Ùƒ ÙŠØ§ ÙØ§Ø·Ù…Ø©/g) || []).length;
      const msg = document.getElementById("resultMsg");
      if (count >= writeCount) {
        msg.textContent = "Ù…Ù…ØªØ§Ø²! ØªØ³ØªØ­Ù‚ Ø±Ø¶Ø§ Ø§Ù„Ù…Ù„ÙƒØ©.";
        msg.style.color = "lightgreen";
        playAudio("success");
        startSecondTask();
      } else {
        msg.textContent = `ÙƒØªØ¨Øª ÙÙ‚Ø· ${count} Ù…Ø±Ø§Øª! Ù„Ø§ ÙŠÙƒÙÙŠ.`;
        msg.style.color = "orange";
        failMission();
      }
    }

    // âœ… Ù…Ù‡Ù…Ø© Ø«Ø§Ù†ÙŠØ©: Ø¨Ø¹Ø¯ Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
    function startSecondTask() {
      document.getElementById("game").classList.add("hidden");
      document.getElementById("photoHider").classList.remove("hidden");
    }

    // ğŸ“· Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±
    document.getElementById("imageInput").addEventListener("change", function () {
      const files = this.files;
      const container = document.getElementById("imageList");
      container.innerHTML = "";
      for (let i = 0; i < files.length; i++) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const img = document.createElement("img");
          img.src = e.target.result;
          container.appendChild(img);
        };
        reader.readAsDataURL(files[i]);
      }
    });
  </script>
</body>
</html>
